@model RecupereJa.ViewModel.PerfilUsuarioViewModel

<form asp-action="Perfil" asp-controller="Usuario" method="post" enctype="multipart/form-data">

	<div class="profile-container row">

		<!-- Sidebar de visualização -->
		<div class="col-md-4 sidebar">
			<div class="text-center">
				@if (Model.FotoPerfilUrl != null && Model.FotoPerfilUrl.Length > 0)
				{
					<img id="FotoDePerfil" src="data:image/*;base64,@(Convert.ToBase64String(Model.FotoPerfilUrl))" class="profile-photo" alt="Profile Photo" />
				}
				else
				{
					<img id="FotoDePerfil" src="@Model.FotoPerfilUrl" class="profile-photo" alt="Profile Photo" />
				}

				<input type="file"
					   accept=".png,.jpg,.jpeg,.gif,.tif"
					   name="FotoDePerfil"
					   class="form-control"
					   style="border:0px!important;padding: 0px;padding-top: 10px;padding-bottom: 30px;"
					   onchange="AlterarImagem()" />
			</div>

			<h2>@Model.Nome</h2>
			<p>@Model.Genero</p>
			<p>@Model.Cidade</p>
			<p class="rating">⭐ @Model.Rating</p>
			<p>@Model.DataNascimentoFormatada</p>

			<div class="contact-info">
				<p>Telefone: <a href="tel:@Model.Telefone">@Model.Telefone</a></p>
				<p>E-mail: <a href="mailto:@Model.Email">@Model.Email</a></p>
			</div>
		</div>

		<!-- Campos de edição -->
		<div class="col-md-8">
			<div asp-validation-summary="ModelOnly" class="text-danger"></div>

			<div class="form-group">
				<label asp-for="Nome"></label>
				<input asp-for="Nome" class="form-control" />
				<span asp-validation-for="Nome" class="text-danger"></span>
			</div>

			<div class="form-group">
				<label asp-for="Telefone"></label>
				<input asp-for="Telefone" class="form-control" />
				<span asp-validation-for="Telefone" class="text-danger"></span>
			</div>

			<button type="submit" class="btn btn-primary">Salvar</button>
		</div>
	</div>
</form>

<script>

	function AlterarImagem (){
			const imagem = document.getElementsByName('FotoDePerfil')[0].files[0];

		document.getElementById('FotoDePerfil').src = window.URL.createObjectURL(imagem)



		// Cria um FormData para enviar a imagem e o ID
		const formData = new FormData();
		formData.append('id', '34');            // Adiciona o ID
		formData.append('imagem', imagem);    // Adiciona a imagem

		// Realiza o fetch para o endpoint
		fetch('./AlterarImagem', {
			method: 'POST',                // Envio de dados via POST
			body: formData,                // Envia o FormData com os dados
		})
		.then(response => {
			if (!response.ok) {
				throw new Error('Erro ao enviar a imagem');
			}
			return response.json();  // Supondo que o backend retorne um JSON
		})
		.then(data => {
			console.log('Imagem alterada com sucesso:', data);
			// Aqui você pode manipular a resposta de sucesso
		})
		.catch(error => {
			console.error('Erro:', error);
			// Aqui você pode tratar os erros
		});
	}
</script>
<form>
	<div class="form-group">
		<label asp-for="Telefone"></label>
		<input asp-for="Telefone" class="form-control" />
		<span asp-validation-for="Telefone" class="text-danger"></span>
	</div>

	<button type="submit" class="btn btn-primary">Salvar</button>
</form>>

@* 
Corrigir essa parte, no Controller(Eu acho) e as entidades no model 
Task de rápida cerca de 1 hora +/-
*@
